version: '2.0'
name: java.install-java
description: Install JAVA on CentOS.

workflows:
    main:
        description: Install JAVA on CentOS.
        type: direct
        input:
            - host
            - username
            - password
            
        tasks:
            get_java_version:
                action: java.get_installed
                input:
                    host: <% $.host %>
                    username: <% $.username %>
                    password: <% $.password %>
                publish:
                    versions: <% task(get_java_version).result.result %>
                on-success:
                    - install_java
            install_java:
                action: java.install
                input:
                    host: <% $.host %>
                    username: <% $.username %>
                    password: <% $.password %>
                    installed_versions: <% $.versions %>
                    required_version: "java-1.8.0"
                on-success:
                    - download_file
            download_file:
                action: java.download_file
                input:
                    host: <% $.host %>
                    username: <% $.username %>
                    password: <% $.password %>
                    downloadURL: https://raw.githubusercontent.com/yugendra/st2-java/master/requirements.txt
                    downloadPath: /tmp/
